=head1 NAME

User_Admin.pm - User Administration module for Rover


=head1 VERSION

1.00


=head1 SYNOPSYS

  # Format for commands.run
  GENERAL:{
    ...

    # Add module to rover runtime environment
    use User_Admin;
  };

  Ruleset:{
    ...

    # List ALL users on a server
    userlist(ALL);

  };

The public functions available are as follows:

  User_Admin::userlist();
  User_Admin::grouplist();
  User_Admin::useradd();
  User_Admin::groupadd();
  User_Admin::userdel();
  User_Admin::groupdel();
  User_Admin::unlock();


=head1 DESCRIPTION

  The purpose of this module is to provide a platform independent set of functions
  around basic user management. It is not intended to provide an equivalent switch
  for all supported variants of user commands per platform.

  The basic use of this module is to include it in the Rover commands.run
  file in the GENERAL section (use User_Admin) and then call a public function
  in any defined ruleset. The Perl module file itself must exist in the modules
  directory, or anywhere within the @INC() path.


=head1 USAGE

=over 4

=item userlist();

  # List all accounts
  userlist(ALL);
   or with a subset, or all options
  userlist(ALL:uid,gid,comment,home,shell,groups);
  
  # List selective accounts
  userlist(root,nobody);
   or with a subset, or all options
  userlist(root,nobody:uid,gid,comment,home,shell,groups);

  One or more users can be provided separated by comma's. And one or more
  options can be provided sperated by comma's. The users and options are separated by
  a colon ':'. The only required item is the username, specifying additional options
  such as gid or comment will cause the output in the log file to contain only those
  fields of the /etc/passwd file. So the following command would provide output similar
  to:

  userlist(nobody:shell);
  
  Output in logfile
  nobody:/sbin/nologin


=item grouplist();

  # List all groups
  grouplist(ALL);
   or with a subset, or all options
  grouplist(ALL:gid,members);

  # List selective groups
  grouplist(bin,nobody);
   or with a subset, or all options
  grouplist(bin,nobody:gid,members);

  One or more groups can be provided separated by comma's. And one or more
  options can be provided separated by comma's. The groups and options are separated by
  a colon ':'. The only required item is the group name, specifying additional options
  such as gid or members will cause the output in the log file to contain only those
  fields of the /etc/group file. So the following command would provide output similar
  to:

  grouplist(nobody:gid);

  Output in logfile
  nobody:99


=item useradd();

  useradd(username,uid,group,comment,home,shell);

  The only required field is username, if any other field is not present, that portion
  of the useradd/mkuser command will be left out.  However, leaving the home and shell
  parameters blank will prompt useradd() to determine their values automatically. See
  below.

  The useradd() function will attempt to determine the location of /home based on the
  current users /home directory.  If this fails it will default to /home.  This
  behavior can be overridden by explicitly specifying the full path to the new users
  home directory.

  Shell is acquired by the $SHELL environment variable on the remote system.  This
  also can be overridden via specifying a shell.

  Example 1:
  useradd(test,50000,users,Test User,/home/test,/bin/bash);

  Example 2:
  useradd(test,,,Test User,,);


=item groupadd();

  groupadd(groupname,gid);

  Group name is required; gid is optional and will be left out of the groupadd/mkgroup
  commands if not specified.

  Example:
  groupadd(test,50000);


=item userdel();

  userdel(username);

  Example:
  userdel(test);


=item groupdel();

  groupdel(group);

  Example:
  groupdel(test);


=item unlock();

  unlock(username, password);

  This will set the password for a user specified.  If the system is an
  AIX server, it will also set the security flags to null, i.e. it will
  not require the user to change the password on next login.

  Example:
  unlock(test, temp123);

=head1 AUTHORS

John Kellner (jpkellner25@users.sourceforge.net)


=head1 LICENSE

This module can be used under the same license as Perl.


=head1 DISCLAIMER

THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESS OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS
OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR
TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.
